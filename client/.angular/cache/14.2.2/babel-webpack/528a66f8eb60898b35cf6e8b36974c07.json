{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/user.service\";\nimport * as i2 from \"src/app/services/notifications.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\n\nfunction SolicitudesComponent_h1_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h1\");\n    i0.ɵɵtext(1, \"No tienes solicitudes de contacto\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SolicitudesComponent_div_4_ng_container_9_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"a\", 12);\n    i0.ɵɵlistener(\"click\", function SolicitudesComponent_div_4_ng_container_9_Template_a_click_1_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const soli_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.acceptSol(soli_r2));\n    });\n    i0.ɵɵelement(2, \"span\", 13);\n    i0.ɵɵtext(3, \" Aceptar solicitud\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"a\", 14);\n    i0.ɵɵlistener(\"click\", function SolicitudesComponent_div_4_ng_container_9_Template_a_click_4_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const soli_r2 = i0.ɵɵnextContext().$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.rechazarSol(soli_r2));\n    });\n    i0.ɵɵelement(5, \"span\", 15);\n    i0.ɵɵtext(6, \" Rechazar solicitud\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n}\n\nfunction SolicitudesComponent_div_4_ng_template_10_a_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"a\", 14);\n    i0.ɵɵlistener(\"click\", function SolicitudesComponent_div_4_ng_template_10_a_0_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const soli_r2 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r12 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r12.revocarPermiso(soli_r2));\n    });\n    i0.ɵɵelement(1, \"span\", 15);\n    i0.ɵɵtext(2, \" Revocar permisos\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SolicitudesComponent_div_4_ng_template_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, SolicitudesComponent_div_4_ng_template_10_a_0_Template, 3, 0, \"a\", 16);\n  }\n\n  if (rf & 2) {\n    const soli_r2 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵproperty(\"ngIf\", soli_r2.estado == 1);\n  }\n}\n\nconst _c0 = function (a1) {\n  return [\"/user\", a1];\n};\n\nfunction SolicitudesComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 4);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 5);\n    i0.ɵɵelement(4, \"img\", 6);\n    i0.ɵɵelementStart(5, \"div\", 7)(6, \"a\", 8);\n    i0.ɵɵelement(7, \"span\", 9);\n    i0.ɵɵtext(8, \" Ver perfil\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(9, SolicitudesComponent_div_4_ng_container_9_Template, 7, 0, \"ng-container\", 10);\n    i0.ɵɵtemplate(10, SolicitudesComponent_div_4_ng_template_10_Template, 1, 1, \"ng-template\", null, 11, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const soli_r2 = ctx.$implicit;\n\n    const _r4 = i0.ɵɵreference(11);\n\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(soli_r2.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"src\", ctx_r1.api_url + soli_r2.foto_perfil, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(5, _c0, soli_r2.username));\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", soli_r2.estado == 0)(\"ngIfElse\", _r4);\n  }\n}\n\nexport class SolicitudesComponent {\n  constructor(userService, ns) {\n    this.userService = userService;\n    this.ns = ns;\n    this.solicitudes = [];\n    this.refresh$ = new BehaviorSubject(true);\n    this.api_url = '';\n  }\n\n  ngOnInit() {\n    this.api_url = this.userService.SV_URL;\n    this.userService.getSolicitudes().subscribe(res => {\n      this.solicitudes = res;\n    }, err => {\n      console.log(err);\n    });\n  }\n\n  acceptSol(solicitud) {\n    solicitud.estado = 1;\n    this.userService.updateSolicitud(solicitud.id, 1).subscribe(res => {\n      this.ns.notification('success', res.message, 'Ahora este usuario podra ver tu informacion de contacto');\n    }, err => {\n      this.ns.notification('error', 'Ha ocurrido un error', err.error.message);\n    });\n  }\n\n  revocarPermiso(solicitud) {\n    solicitud.estado = 0;\n    this.userService.updateSolicitud(solicitud.id, 0).subscribe(res => {\n      this.ns.notification('success', 'Permisos revocados con exito', 'Este usuario ya no podra ver tu informacion de contacto');\n    }, err => {\n      this.ns.notification('error', 'Ha ocurrido un error', err.error.message);\n    });\n  }\n\n  rechazarSol(solicitud) {\n    solicitud.estado = 2;\n    this.userService.updateSolicitud(solicitud.id, 2).subscribe(res => {\n      this.ns.notification('success', 'Solicitud rechazada con exito', 'Este usuario no podra ver tu informacion de contacto');\n      this.ngOnInit();\n    }, err => {\n      this.ns.notification('error', 'Ha ocurrido un error', err.error.message);\n    });\n  }\n\n}\n\nSolicitudesComponent.ɵfac = function SolicitudesComponent_Factory(t) {\n  return new (t || SolicitudesComponent)(i0.ɵɵdirectiveInject(i1.UserService), i0.ɵɵdirectiveInject(i2.NotificationsService));\n};\n\nSolicitudesComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: SolicitudesComponent,\n  selectors: [[\"app-solicitudes\"]],\n  decls: 7,\n  vars: 5,\n  consts: [[1, \"fl-container\", \"solicitudes\"], [1, \"text-center\"], [4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [1, \"fl-header\"], [1, \"fl-card\"], [\"alt\", \"\", 3, \"src\"], [1, \"fl-links\"], [3, \"routerLink\"], [1, \"fas\", \"fa-user-alt\"], [4, \"ngIf\", \"ngIfElse\"], [\"soliAceptada\", \"\"], [1, \"bg-green\", 3, \"click\"], [1, \"fas\", \"fa-check-circle\"], [1, \"bg-red\", 3, \"click\"], [1, \"fas\", \"fa-minus-square\"], [\"class\", \"bg-red\", 3, \"click\", 4, \"ngIf\"]],\n  template: function SolicitudesComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"h1\", 1);\n      i0.ɵɵtext(2, \"Solicitudes de contacto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(3, SolicitudesComponent_h1_3_Template, 2, 0, \"h1\", 2);\n      i0.ɵɵtemplate(4, SolicitudesComponent_div_4_Template, 12, 7, \"div\", 3);\n      i0.ɵɵtext(5);\n      i0.ɵɵpipe(6, \"async\");\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.solicitudes.length == 0);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.solicitudes);\n      i0.ɵɵadvance(1);\n      i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(6, 3, ctx.solicitudes$), \"\\n\");\n    }\n  },\n  dependencies: [i3.NgForOf, i3.NgIf, i4.RouterLinkWithHref, i3.AsyncPipe],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzb2xpY2l0dWRlcy5jb21wb25lbnQuc2NzcyJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["BehaviorSubject","i0","_r4","SolicitudesComponent","constructor","userService","ns","ngOnInit","api_url","SV_URL","getSolicitudes","subscribe","res","solicitudes","err","console","log","acceptSol","solicitud","estado","updateSolicitud","id","notification","message","error","revocarPermiso","rechazarSol","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/aksel/projects/roomeet/client/src/app/components/solicitudes/solicitudes.component.ts","/home/aksel/projects/roomeet/client/src/app/components/solicitudes/solicitudes.component.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { BehaviorSubject, Observable, switchMap } from 'rxjs';\nimport { NotificationsService } from 'src/app/services/notifications.service';\nimport { UserService } from 'src/app/services/user.service';\n\n@Component({\n  selector: 'app-solicitudes',\n  templateUrl: './solicitudes.component.html',\n  styleUrls: ['./solicitudes.component.scss']\n})\nexport class SolicitudesComponent implements OnInit {\n  solicitudes: any = [];\n  refresh$ = new BehaviorSubject<boolean>(true);\n  api_url = '';\n\n  constructor(private userService: UserService, private ns: NotificationsService) { }\n\n  ngOnInit(): void {\n    this.api_url = this.userService.SV_URL;\n    this.userService.getSolicitudes().subscribe((res: any) => {\n      this.solicitudes = res;\n    }, err => {\n      console.log(err);\n    })\n  }\n\n  acceptSol(solicitud: any) {\n    solicitud.estado = 1;\n\n    this.userService.updateSolicitud(solicitud.id, 1).subscribe((res: any) => {\n      this.ns.notification('success', res.message, 'Ahora este usuario podra ver tu informacion de contacto');\n    }, err => {\n      this.ns.notification('error', 'Ha ocurrido un error', err.error.message);\n    })\n  }\n\n  revocarPermiso(solicitud: any) {\n    solicitud.estado = 0;\n\n    this.userService.updateSolicitud(solicitud.id, 0).subscribe((res: any) => {\n      this.ns.notification('success', 'Permisos revocados con exito', 'Este usuario ya no podra ver tu informacion de contacto');\n    }, err => {\n      this.ns.notification('error', 'Ha ocurrido un error', err.error.message);\n    })\n  }\n\n  rechazarSol(solicitud: any) {\n    solicitud.estado = 2;\n\n    this.userService.updateSolicitud(solicitud.id, 2).subscribe((res: any) => {\n      this.ns.notification('success', 'Solicitud rechazada con exito', 'Este usuario no podra ver tu informacion de contacto');\n      this.ngOnInit();\n    }, err => {\n      this.ns.notification('error', 'Ha ocurrido un error', err.error.message);\n    })\n  }\n\n}\n","<div class=\"fl-container solicitudes\">\n    <h1 class=\"text-center\">Solicitudes de contacto</h1>\n    <h1 *ngIf=\"solicitudes.length == 0\">No tienes solicitudes de contacto</h1>\n    <div *ngFor=\"let soli of solicitudes\">\n        <div class=\"fl-header\">{{soli.nombre}}</div>\n        <div class=\"fl-card\">\n            <img [src]=\"api_url + soli.foto_perfil\" alt=\"\">\n            <div class=\"fl-links\">\n                <a [routerLink]=\"['/user', soli.username]\"><span class=\"fas fa-user-alt\"></span> Ver perfil</a>\n                <ng-container *ngIf=\"soli.estado == 0;else soliAceptada\">\n                    <a  class=\"bg-green\" (click)=\"acceptSol(soli)\"><span class=\"fas fa-check-circle\"></span> Aceptar solicitud</a>\n                    <a class=\"bg-red\" (click)=\"rechazarSol(soli)\"><span class=\"fas fa-minus-square\"></span> Rechazar solicitud</a>\n                </ng-container>\n                <ng-template #soliAceptada><a *ngIf=\"soli.estado == 1\" class=\"bg-red\" (click)=\"revocarPermiso(soli)\"><span class=\"fas fa-minus-square\"></span> Revocar permisos</a></ng-template>\n            </div>\n        </div>\n    </div>\n\n    {{solicitudes$ | async}}\n</div>"]},"metadata":{},"sourceType":"module"}